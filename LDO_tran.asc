Version 4
SHEET 1 26844 1204
WIRE 336 -544 240 -544
WIRE 432 -544 336 -544
WIRE 4304 -512 3840 -512
WIRE 4848 -512 4304 -512
WIRE 1264 -480 -512 -480
WIRE 4304 -448 4304 -512
WIRE 4352 -448 4304 -448
WIRE 4400 -448 4368 -448
WIRE 4416 -448 4416 -528
WIRE 4496 -448 4496 -528
WIRE 2992 -432 2528 -432
WIRE 240 -416 240 -544
WIRE 240 -416 64 -416
WIRE 4304 -368 4304 -448
WIRE 4400 -368 4384 -368
WIRE 4496 -368 4496 -448
WIRE 4496 -368 4400 -368
WIRE 2096 -336 1856 -336
WIRE 4208 -320 4208 -384
WIRE 4304 -320 4304 -368
WIRE 4304 -320 4288 -320
WIRE 240 -304 240 -416
WIRE 432 -304 432 -544
WIRE 4304 -288 4304 -320
WIRE 4320 -288 4304 -288
WIRE 4400 -272 4400 -368
WIRE 4400 -272 4384 -272
WIRE 4432 -272 4400 -272
WIRE 2736 -256 2736 -352
WIRE 4320 -256 4304 -256
WIRE 4304 -240 4304 -256
WIRE 4304 -240 4288 -240
WIRE 1904 -224 1632 -224
WIRE 1968 -224 1904 -224
WIRE 4304 -208 4304 -240
WIRE 240 -176 240 -224
WIRE 432 -176 432 -224
WIRE 1824 -144 1312 -144
WIRE 336 -128 304 -128
WIRE 368 -128 336 -128
WIRE 2528 -64 2528 -432
WIRE 2992 -64 2992 -432
WIRE 2992 -64 2528 -64
WIRE 1632 -48 1632 -224
WIRE 1632 -48 1584 -48
WIRE 1968 -48 1968 -64
WIRE 240 -32 240 -80
WIRE 336 -32 336 -128
WIRE 336 -32 240 -32
WIRE 64 -16 64 -416
WIRE 1472 -16 1408 -16
WIRE 1520 -16 1472 -16
WIRE 3840 -16 3840 -512
WIRE 4848 -16 4848 -512
WIRE 4848 -16 3840 -16
WIRE 432 0 432 -80
WIRE 1856 0 1856 -336
WIRE 2096 0 2096 -336
WIRE 2096 0 1856 0
WIRE 1632 16 1584 16
WIRE 2288 16 2256 16
WIRE -544 48 -784 48
WIRE 2400 48 1872 48
WIRE 4192 48 3184 48
WIRE 240 64 240 -32
WIRE 432 64 432 0
WIRE 1472 96 1472 64
WIRE 1504 96 1472 96
WIRE 1632 96 1632 16
WIRE 1632 96 1568 96
WIRE -672 112 -736 112
WIRE -144 112 -592 112
WIRE 528 112 496 112
WIRE 1296 112 864 112
WIRE 1408 112 1408 -16
WIRE 1408 112 1296 112
WIRE 1632 112 1632 96
WIRE 2192 112 2192 16
WIRE 2288 112 2288 16
WIRE 2288 112 2272 112
WIRE 3936 112 3872 112
WIRE 1632 128 1632 112
WIRE 1936 128 1632 128
WIRE 2048 128 1936 128
WIRE 2096 160 2016 160
WIRE 2192 160 2192 112
WIRE 2192 160 2176 160
WIRE 1936 176 1936 128
WIRE -736 192 -736 112
WIRE 64 192 64 64
WIRE 176 192 64 192
WIRE 2192 192 2192 160
WIRE 2208 192 2192 192
WIRE 3808 192 3808 112
WIRE 3936 192 3936 112
WIRE 3936 192 3888 192
WIRE 3984 192 3936 192
WIRE 240 208 240 160
WIRE 336 208 240 208
WIRE 432 208 432 160
WIRE 432 208 336 208
WIRE 2288 208 2288 112
WIRE 2288 208 2272 208
WIRE 2320 208 2288 208
WIRE 2208 224 2192 224
WIRE 2048 240 2048 128
WIRE 2096 240 2048 240
WIRE 2192 240 2192 224
WIRE 2192 240 2176 240
WIRE 64 256 64 192
WIRE 336 256 336 208
WIRE 1936 256 1632 256
WIRE 2016 256 2016 160
WIRE 2016 256 1936 256
WIRE 2192 272 2192 240
WIRE 3808 288 3808 192
WIRE 3856 288 3808 288
WIRE 176 304 176 192
WIRE 176 304 128 304
WIRE 272 304 176 304
WIRE 3984 304 3984 192
WIRE 3984 304 3920 304
WIRE 4096 304 3984 304
WIRE 4128 304 4096 304
WIRE -736 320 -736 272
WIRE 1520 320 1408 320
WIRE 1632 320 1632 256
WIRE 1632 320 1520 320
WIRE 1664 320 1632 320
WIRE 1792 320 1728 320
WIRE 3344 320 3280 320
WIRE 3504 320 3424 320
WIRE 3680 320 3504 320
WIRE 3808 320 3760 320
WIRE 3856 320 3808 320
WIRE 1792 336 1792 320
WIRE 3504 352 3504 320
WIRE -784 384 -784 48
WIRE -544 384 -544 48
WIRE -544 384 -784 384
WIRE 1312 400 1312 -144
WIRE 1824 400 1824 -144
WIRE 1824 400 1312 400
WIRE 1872 400 1872 48
WIRE 2400 400 2400 48
WIRE 2400 400 1872 400
WIRE 64 416 64 352
WIRE 336 416 336 352
WIRE 1776 416 1456 416
WIRE 1968 416 1840 416
WIRE 1632 432 1632 320
WIRE 1840 432 1840 416
WIRE 1840 432 1632 432
WIRE 3696 432 3632 432
WIRE 3808 432 3808 320
WIRE 3808 432 3776 432
WIRE 1632 448 1632 432
WIRE 1840 448 1840 432
WIRE 3504 448 3504 432
WIRE 1920 480 1872 480
WIRE 64 528 64 496
WIRE 336 528 336 496
WIRE 336 528 64 528
WIRE -512 544 -512 -480
WIRE 1264 544 1264 -480
WIRE 1264 544 -512 544
WIRE 1456 544 1456 416
WIRE 1776 544 1776 416
WIRE 1776 544 1456 544
WIRE 3184 544 3184 48
WIRE 4192 544 4192 48
WIRE 4192 544 3184 544
WIRE 1488 560 480 560
WIRE 1632 560 1632 528
WIRE 720 592 560 592
WIRE 944 592 720 592
WIRE 1408 592 1408 320
WIRE 1408 592 1024 592
WIRE 720 608 720 592
WIRE 720 768 720 688
WIRE 768 768 720 768
WIRE 768 784 768 768
WIRE 720 800 720 768
WIRE 896 864 816 864
WIRE 720 896 720 880
WIRE 768 896 768 880
WIRE 768 896 720 896
WIRE 896 896 896 864
WIRE 720 992 720 896
WIRE 896 992 896 976
WIRE 480 1024 480 560
WIRE 1488 1024 1488 560
WIRE 1488 1024 480 1024
FLAG 1632 560 0
FLAG -736 320 0
FLAG 1296 112 Va
FLAG -736 112 Vref
FLAG 720 992 0
FLAG 1520 320 Vo
FLAG 1968 -48 0
FLAG 1792 336 0
FLAG 336 528 0
FLAG 560 592 Vf
FLAG 336 -544 VREG
FLAG -144 112 Vi
FLAG 432 0 va
FLAG 864 112 va
FLAG 528 112 Vi
FLAG 176 112 Vf
FLAG 1904 -224 VREG
FLAG 896 992 0
FLAG 2736 -352 VREG
FLAG 2784 -240 Vact
FLAG 2736 -160 Va
FLAG 2320 208 Vsens
FLAG 2192 352 0
FLAG 3504 448 0
FLAG 4096 304 Vref2
FLAG 3280 320 Vref
FLAG 3632 432 Vf
FLAG 3728 192 0
FLAG 4304 -128 0
FLAG 4432 -272 Vact
FLAG 4208 -240 Vref2
FLAG 4208 -384 Vsens
FLAG 1632 112 Vs
FLAG 1872 560 0
FLAG 1968 576 0
FLAG 1920 432 0
DATAFLAG 1632 16 ""
DATAFLAG 2304 208 ""
DATAFLAG 624 592 ""
SYMBOL voltage -736 176 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 66 94 Right 2
SYMATTR Value 1.2
SYMATTR InstName Vref
SYMBOL res 1616 432 R0
SYMATTR InstName RL
SYMATTR Value {RLOAD}
SYMBOL res 704 592 R0
SYMATTR InstName R1
SYMATTR Value 22k
SYMBOL res 736 896 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 18k
SYMBOL voltage 1968 -160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 34 41 Left 2
SYMATTR InstName VREG
SYMATTR Value PULSE(0 6.35 .1 .01 0 1)
SYMBOL voltage 1968 -240 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 0
SYMBOL npn 176 64 R0
SYMATTR InstName Q1
SYMATTR Value BC548B
SYMBOL npn 496 64 M0
SYMATTR InstName Q2
SYMATTR Value BC548B
SYMBOL pnp 368 -80 M180
SYMATTR InstName Q3
SYMATTR Value BC558B
SYMBOL pnp 304 -80 R180
SYMATTR InstName Q4
SYMATTR Value BC558B
SYMBOL res 224 -320 R0
SYMATTR InstName R5
SYMATTR Value 220
SYMBOL res -576 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10
SYMBOL res 1040 576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 70k
SYMBOL voltage 896 880 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName SEL
SYMATTR Value 0
SYMBOL npn 272 256 R0
SYMATTR InstName Q5
SYMATTR Value BC548B
SYMBOL npn 128 256 M0
SYMATTR InstName Q6
SYMATTR Value BC548B
SYMBOL res 48 -32 R0
SYMATTR InstName R8
SYMATTR Value 5.4k
SYMBOL res 48 400 R0
SYMATTR InstName R2
SYMATTR Value 100
SYMBOL res 320 400 R0
SYMATTR InstName R4
SYMATTR Value 100
SYMBOL res 1920 160 R0
SYMATTR InstName Rs
SYMATTR Value .1
SYMBOL res 416 -320 R0
SYMATTR InstName R12
SYMATTR Value 220
SYMBOL nmos 816 784 M0
WINDOW 0 -42 16 Left 2
WINDOW 3 -80 47 Left 2
SYMATTR InstName M2
SYMATTR Value 2N7000
SYMBOL AutoGenerated\\irf9520 1552 -16 R0
SYMATTR InstName U1
SYMBOL pmos 2784 -160 R180
SYMATTR InstName M1
SYMATTR Value FDC5614P
SYMBOL OpAmps\\opamp 2240 144 R0
SYMATTR InstName U2
SYMBOL res 2192 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 11k
SYMBOL res 2192 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 11k
SYMBOL res 2288 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 120k
SYMBOL res 2208 368 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R14
SYMATTR Value 120k
SYMBOL res 3488 336 R0
SYMATTR InstName R22
SYMATTR Value 40k
SYMBOL res 3440 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 70k
SYMBOL res 3792 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 1Meg
SYMBOL res 3776 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R25
SYMATTR Value 1Meg
SYMBOL OpAmps\\opamp 3888 240 R0
SYMATTR InstName U5
SYMBOL res 3824 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 1Meg
SYMBOL res 3904 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 1Meg
SYMBOL OpAmps\\opamp 4352 -336 R0
SYMATTR InstName U3
SYMBOL res 4304 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res 4304 -256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 10k
SYMBOL res 4400 -384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 1Meg
SYMBOL res 4320 -112 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R18
SYMATTR Value 1Meg
SYMBOL cap 1728 304 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value {CLOAD}
SYMBOL cap 1568 80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL res 1488 80 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R9
SYMATTR Value 200
SYMBOL sw 1968 400 R0
SYMATTR InstName S1
SYMATTR Value MYSW
SYMBOL res 1952 480 R0
SYMATTR InstName R19
SYMATTR Value 0.01
SYMBOL voltage 1872 464 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 1 .8 .01 0 1)
SYMBOL res 4512 -464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1k
SYMBOL cap 4416 -464 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 100p
TEXT -768 368 Left 2 ;Referencia
TEXT 488 736 Left 2 ;Realimentador
TEXT -504 -464 Left 2 ;a
TEXT 1320 -128 Left 2 ;Transistor de paso
TEXT 1504 528 Left 2 ;Carga
TEXT -1320 1112 Left 2 !.model BC558B PNP(Is=1.02f Xti=3 Eg=1.11 Vaf=52.31 Bf=306.5 Ise=10.27f Ne=1.764 Ikf=91.85m Nk=.5351 Xtb=1.5 Br=6.48 Isc=1.472f Nc=1.294 Ikr=.5584 Rc=1.086 Cjc=9.81p Mjc=.332 Vjc=.4865 Fc=.5 Cje=30p Mje=.3333 Vje=.5 Tr=10n Tf=611.6p Itf=1.373 Xtf=26.05 Vtf=10 Vceo=30 Icrating=100m mfg=Philips)
TEXT -1320 1136 Left 2 !.model BC548B NPN(Is=7.049f Xti=3 Eg=1.11 Vaf=62.79 Bf=374.6 Ise=68f Ne=1.576 Ikf=81.57m Nk=.4767 Xtb=1.5 Br=1 Isc=12.4f Nc=1.835 Ikr=3.924 Rc=.9747 Cjc=5.25p Mjc=.3147 Vjc=.5697 Fc=.5 Cje=11.5p Mje=.6715 Vje=.5 Tr=10n Tf=410.2p Itf=1.491 Xtf=40.06 Vtf=10 Vceo=30 Icrating=100m mfg=Philips)
TEXT 2040 -312 Left 2 ;Buck
TEXT 2032 952 Left 2 !.inc sihf9520.lib
TEXT -1312 1168 Left 2 !.model 2N7000 VDMOS(Rg=3 Vto=3 Rd=0 Rs=.75 Rb=.14 Kp=.17 mtriode=1.25 Cgdmax=80p Cgdmin=12p Cgs=50p Cjo=50p Is=.04p mfg=Fairchild Vds=60 Ron=5 Qg=.223n)
TEXT 2592 -352 Left 2 ;Actuador
TEXT 2432 40 Left 2 !.lib opamp.sub
TEXT 3256 88 Left 2 ;Sumador
TEXT 3912 -472 Left 2 ;Amplificador de Error
TEXT 1904 80 Left 2 ;Sensado de Corriente
TEXT 2056 672 Left 2 !;.step param RLOAD 5 250 245
TEXT 2056 632 Left 2 !;.step param CLOAD 1u 15u 14u
TEXT 2056 584 Left 2 !.param CLOAD 1u
TEXT 2056 552 Left 2 !.param RLOAD 150
TEXT 2024 776 Left 2 !.tran 0 1 0 .001
TEXT 2608 768 Left 2 !.model MYSW SW(Ron=1 Roff=1Meg Vt=.5 Vh=-.4)
